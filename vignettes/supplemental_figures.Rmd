---
title: "Supplemental Figures"
author: "Sean Maden"
date: "10/8/2020"
output: html_document
---

```{r setup, include=FALSE}
library(recountmethylationManuscriptSupplement)
pkgname <- "recountmethylationManuscriptSupplement"
scripts.dir <- system.file("scripts", package = pkgname)

library(ggplot2)
library(gridExtra)
library(data.table)

knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
```

# Figure S1

Obtain sample (GSM IDs) and study (GSE IDs) summaries from queries to GEO 
with queries to Entrez utilities. With 
[Entrez utilities](https://www.ncbi.nlm.nih.gov/books/NBK179288/) installed, navigate 
to the directory with the script "eqplot.py" and run:

```
python3 eqplot.py
```

This will cause data queries to the GEO servers, and result in the creation 
of several new files, "gsmyeardata", "gsmidatyrdata", "gseyeardata", and 
"gseidatyrdata". Finally, run the script "fig1a.R" to make the plot.

```{r, eval = TRUE}
script.name <- "figS1.R"
source(file.path(scripts.dir, script.name))
figS1
```

# Figure S2

```{r}
script.name <- "figS2.R"
source(file.path(scripts.dir, script.name))
figS2
```

# Figure S3

```{r}
script.name <- "figS3.R"
source(file.path(scripts.dir, script.name))
figS3
```

# Figure S4

```{r}
script.name <- "figS4.R"
source(file.path(scripts.dir, script.name))
figS4
```

# Figure S5

```{r}
script.name <- "figS5.R"
source(file.path(scripts.dir, script.name))
figS5
```

# Figure S6

Details including sample identification, analyses, and results summaries are detailed in 
the script `pca_fig3.R`. This script generates the files contained in 
`r system.file("extdata", "pcadata", package = pkgname)`, which are used below to 
generate the main plots.

```{r, eval = TRUE}
script.name <- "figS6.R"
source(file.path(scripts.dir, script.name))
figS6a
```
```{r, eval = TRUE}
figS6b
```

# Figure S7

This section shows how to generate the data summary plots for DNAm variability analyses in 7
noncancer tissues. Source the script to generate the barplots summarizing studies and samples (fig7b) and 
the anova filter summary stacked barplot.

```{r, eval = TRUE}
script.name <- "figS7.R"
source(file.path(scripts.dir, script.name))
figS7b.studies
```
```{r, eval = TRUE}
figS7b.samples
```
```{r, eval = TRUE}
figS7c
```

# Figure S8

This section shows how to generate a composite of stacked barplots summarizing
genome mapping patterns in probes with low variance across 7 noncancer tissues.

```{r, eval = TRUE}
script.name <- "figS8.R"
source(file.path(scripts.dir, script.name))
grid.arrange(figS8.plot1, figS8.plot2, figS8.plot3, ncol = 3)
```
