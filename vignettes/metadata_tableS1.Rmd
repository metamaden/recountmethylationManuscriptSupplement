---
title: "metadata_tableS1"
author: "Sean Maden"
date: "10/9/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
pkgname <- "recountmethylationManuscriptSupplement"
scripts.dir <- system.file("extdata", "scripts", package = pkgname)
```

This vignette shows how the sample metadata table (Table S1) was created.

# Preprocessing

## Conversion of SOFT labels

## Addition of MetaSRA-pipeline sample predictions

## Addition of model-based predictions

# Postprocessing

## Term mappings and annotations

```{r}
script.name <- "metadata_postprocessing.R"
source(file.path(scripts.dir, script.name))
```

## Table S1 columns descriptions

Descriptions of the Table S1 columns are as follows:

 1. `gsm` : GEO sample record ID

 2. `gsm_title` : GEO sample record title

 3. `gseid` : GEO study record ID

 4. `disease` : Learned disease characteristics and study group labels

 5. `tissue` : Learned tissue characteristics labels

 6. `sampletype` : Most likely sample type from MetaSRA-pipeline
* `msraptype`: Sample label
* `msrapconf`: Prediction confidence
* `ccid`, `ccacc`, and `cccat`: Mapped cellosaurus id, accession, and 
attribute info where available/applicable

7. `arrayid_full`: Full array Sentrix ID (format: 
`Sentrix ID`_`chip coordinate`)

8. `basename`: Basename, or shared path, to sample IDAT files

9. `age`: Learned chronological age and age units.
* `valm`: Age value
* `unitm`: Age units

10. `predage`: DNAm-based age estimate, predicted using noob-normalized 
Beta-valuees and `agep()` from the `wateRmelon` package.

11. `sex`: Learned sex label (M = male, F = female).

12. `predsex` : DNAm-based sex, predicted from unnormalized red and green 
signal using `getSex()` from the `minfi` R package (M = male, F = female).

13. `predcell.CD8T` : DNAm-based CD8T cell fraction prediction from 
`estimateCellCounts()` in `minfi`.

14. `predcell.CD4T` : DNAm-based CD4T cell fraction prediction from 
`estimateCellCounts()` in `minfi`.

15. `predcell.NK` : DNAm-based Natural Killer cell prediction from 
`estimateCellCounts()` in `minfi`.

16. `predcell.Bcell` : DNAm-based Bcell fraction prediction from 
`estimateCellCounts()` in `minfi`.

17. `predcell.Mono` : DNAm-based Monocyte fraction prediction from 
`estimateCellCounts()` in `minfi`.

18. `predcell.Gran` : DNAm-based Granulocyte fraction prediction from 
`estimateCellCounts()` in `minfi`.

19. `storage` : Annotated storage procedure (`FFPE` for formalin-fixed 
paraffin embedded or `F` for fresh frozen).

